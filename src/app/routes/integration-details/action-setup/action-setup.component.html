<div class="modal-header">
  <h4 class="modal-title pull-left">{{title}}</h4>
</div>
<div class="action-setup-modal modal-body action-setup-modal" style="height: 250px">
  <form id="ngForm" #actionSetupForm="ngForm" novalidate (ngSubmit)="!actionSetupForm.form.valid || !currentActionSetup.App || !currentActionSetup.Action || saveAction()">
    <div class="form-group">
      <label>App</label>
      <input autocomplete="off" class="form-control" name="appName" #appName="ngModel" [(ngModel)]="selectedAppName" [typeaheadMinLength]="0" placeholder="start typing.."
             [typeahead]="apps" required typeaheadOptionField="Name" (typeaheadOnSelect)="onAppSelect($event)">
      <span class="text-danger" [hidden]="(appName.valid && currentActionSetup.App != null) || !actionSetupForm.submitted">
        App Name is required.
      </span>
    </div>
    <div *ngIf="currentActionSetup.App && currentActionSetup.App.Name" class="form-group">
      <label>Action</label>
      <input [ngBusy]="{busy: showBusy, message: 'Loading actions...', backdrop: true}" autocomplete="off" name="selectedActionName" #actionName="ngModel" required [(ngModel)]="selectedActionName" [typeaheadMinLength]="0" placeholder="start typing.." [typeahead]="actions"
             typeaheadOptionField="Title" class="form-control" (typeaheadOnSelect)="onActionSelect($event)">
      <span class="text-danger" [hidden]="(actionName.valid && currentActionSetup.Action != null) || !actionSetupForm.submitted">
        Action Name is required.
      </span>
    </div>
    <div *ngIf="appKeyCaption && appKeyCaption.KeyCaption1" class="form-group">
      <div>
        {{appKeyCaption.KeyCaption1}}
      </div>
      <div>
        <input type="text" name="KeyCaption1Value" [(ngModel)]="appKeyCaption.KeyCaption1Value" required class="form-control" size="20">
        <span class="text-danger" [hidden]="appKeyCaption.KeyCaption1Value || !triggerSetupForm.submitted">
          Field is required.
        </span>
      </div>
    </div>
    <div *ngIf="appKeyCaption && appKeyCaption.KeyCaption2" class="form-group">
      <div>
        {{appKeyCaption.KeyCaption2}}
      </div>
      <div>
        <input type="text" name="KeyCaption2Value" [(ngModel)]="appKeyCaption.KeyCaption2Value" required class="form-control" size="20">
        <span class="text-danger" [hidden]="appKeyCaption.KeyCaption2Value || !triggerSetupForm.submitted">
          Field is required.
        </span>
      </div>
    </div>
    <div *ngIf="appKeyCaption && appKeyCaption.KeyCaption3" class="form-group">
      <div>
        {{appKeyCaption.KeyCaption3}}
      </div>
      <div>
        <input type="text" name="KeyCaption3Value" [(ngModel)]="appKeyCaption.KeyCaption3Value" required class="form-control" size="20">
        <span class="text-danger" [hidden]="appKeyCaption.KeyCaption3Value || !triggerSetupForm.submitted">
          Field is required.
        </span>
      </div>
    </div>
    <div *ngIf="appKeyCaption && appKeyCaption.KeyCaption4" class="form-group">
      <div>
        {{appKeyCaption.KeyCaption4}}
      </div>
      <div>
        <input type="text" name="KeyCaption4Value" [(ngModel)]="appKeyCaption.KeyCaption4Value" required class="form-control" size="20">
        <span class="text-danger" [hidden]="appKeyCaption.KeyCaption4Value || !triggerSetupForm.submitted">
          Field is required.
        </span>
      </div>
    </div>
    <div *ngIf="appKeyCaption && appKeyCaption.KeyCaption5" class="form-group">
      <div>
        {{appKeyCaption.KeyCaption5}}
      </div>
      <div>
        <input type="text" name="KeyCaption5Value" [(ngModel)]="appKeyCaption.KeyCaption5Value" required class="form-control" size="20">
        <span class="text-danger" [hidden]="appKeyCaption.KeyCaption5Value || !triggerSetupForm.submitted">
          Field is required.
        </span>
      </div>
    </div>
    <div *ngIf="appKeyCaption && appKeyCaption['AppKeys'].length > 0" class="form-group">
      <div *ngFor="let appKeysName of appKeyCaption['AppKeys']">
        <label>{{appKeysName.Name}}</label>
        <input type="text" [name]="'name'+appKeyCaption['AppKeys'].indexOf(appKeysName)" [(ngModel)]="appKeysName.Value" required class="form-control" size="20">
        <span class="text-danger" [hidden]="(appKeysName.Value != null) || !actionSetupForm.submitted">
          Field is required.
        </span>
      </div>
    </div>
    <div *ngIf="credentialsKeys && credentialsKeys.length > 0" class="form-group">
      <div>
        App Keys
      </div>
      <div>
        <select class="form-control" name="selectedCredentialKey" [(ngModel)]="selectedCredentialKey">
          <option *ngFor="let credentialsKey of credentialsKeys" [ngValue]="credentialsKey">{{credentialsKey.DisplayValue}}</option>
        </select>
        <a class="manage-btn" href="../../AppKeys.htm">manage</a>
      </div>
    </div>
  </form>
</div>
<div class="modal-footer">
  <button type="submit" form="ngForm" class="btn btn-primary">
    Save
  </button>
</div>
